#!/bin/sh
# vim:se tw=0 sts=2 ts=2 et ai:

if [ "${DEBEMAIL##*@}" != "debian.org" ]; then
  echo "You must have a debian.org e-mail address" >&2
  echo "and set \$DEBEMAIL environment variable to it." >&2
  exit 1
fi

# Normal
VERBOSE=""
# For debug
#VERBOSE="-vvv"
# If strict host check, use this.
#STRICTCK=''
# No strict check, use this. (Double quotes are important)
STRICTCK='-o "StrictHostKeyChecking no"'

# eval is the trick to keep the above double quotes in place
if [ -n "$DEBEMAIL" ]; then
  eval /usr/bin/ssh \
    "${VERBOSE}" \
	  -p 22 \
	  "${STRICTCK}" \
	  "${DEBEMAIL%%@*}@people.debian.org" \
	  /usr/sbin/sendmail -bm -ti \
    -f "$DEBEMAIL"
fi

